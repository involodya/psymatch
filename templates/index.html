{% extends "base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - PsyMatch Admin{% endblock %}

{% block extra_style %}
<style>
    .dashboard {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .stat-card h3 {
        font-size: 14px;
        margin-bottom: 10px;
        opacity: 0.9;
    }

    .stat-card .value {
        font-size: 32px;
        font-weight: bold;
    }

    .section-title {
        font-size: 24px;
        margin-bottom: 20px;
        color: #333;
        border-bottom: 2px solid #667eea;
        padding-bottom: 10px;
    }

    .feature-flags {
        margin-top: 30px;
    }

    .flag-card {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: box-shadow 0.3s;
    }

    .flag-card:hover {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .flag-info h3 {
        color: #333;
        margin-bottom: 5px;
    }

    .flag-info p {
        color: #666;
        font-size: 14px;
    }

    .flag-control {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .toggle-switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 34px;
    }

    .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 34px;
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 26px;
        width: 26px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }

    input:checked + .slider {
        background-color: #28a745;
    }

    input:checked + .slider:before {
        transform: translateX(26px);
    }

    .status-badge {
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: bold;
    }

    .status-enabled {
        background-color: #d4edda;
        color: #155724;
    }

    .status-disabled {
        background-color: #f8d7da;
        color: #721c24;
    }

    .save-btn {
        background: #667eea;
        color: white;
        border: none;
        padding: 8px 20px;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s;
    }

    .save-btn:hover {
        background: #5568d3;
    }
</style>
{% endblock %}

{% block content %}
<div style="margin-bottom: 20px;">
    <a href="{{ url_for('users') }}" style="background: #667eea; color: white; padding: 10px 20px; border-radius: 5px; text-decoration: none; display: inline-block;">
        üë• –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
    </a>
</div>

<h2 class="section-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
<div class="dashboard">
    <div class="stat-card">
        <h3>–ü—Å–∏—Ö–æ–ª–æ–≥–æ–≤</h3>
        <div class="value">{{ stats.psychologists_count }}</div>
    </div>
    <div class="stat-card">
        <h3>–ü–∞—Ü–∏–µ–Ω—Ç–æ–≤</h3>
        <div class="value">{{ stats.patients_count }}</div>
    </div>
    <div class="stat-card">
        <h3>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞ 24—á</h3>
        <div class="value">{{ stats.active_users_24h }}</div>
    </div>
    <div class="stat-card">
        <h3>–í—Å–µ–≥–æ –ø–∞—Ä</h3>
        <div class="value">{{ stats.mutual_matches }}</div>
    </div>
</div>

<div class="feature-flags">
    <h2 class="section-title">üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏—á–∞-—Ñ–ª–∞–≥–∞–º–∏</h2>
    
    {% for flag in flags %}
    <div class="flag-card">
        <div class="flag-info">
            <h3>{{ flag.flag_name }}</h3>
            <p>{{ flag.description }}</p>
        </div>
        <div class="flag-control">
            <span class="status-badge {% if flag.enabled %}status-enabled{% else %}status-disabled{% endif %}">
                {% if flag.enabled %}–í–∫–ª—é—á–µ–Ω{% else %}–í—ã–∫–ª—é—á–µ–Ω{% endif %}
            </span>
            <form method="POST" action="{{ url_for('toggle_flag', flag_name=flag.flag_name) }}">
                <label class="toggle-switch">
                    <input type="checkbox" name="enabled" {% if flag.enabled %}checked{% endif %} onchange="this.form.submit()">
                    <span class="slider"></span>
                </label>
            </form>
        </div>
    </div>
    {% endfor %}
</div>

<div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffc107;">
    <h3 style="color: #856404; margin-bottom: 10px;">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏—á–∞-—Ñ–ª–∞–≥–∞—Ö</h3>
    <p style="color: #856404; margin-bottom: 10px;">
        <strong>psychological_test_and_matching</strong> - —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º —Ç–µ—Å—Ç–æ–º –∏ –ø–æ–¥–±–æ—Ä–æ–º –ø–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
    </p>
    <ul style="color: #856404; margin-left: 20px;">
        <li><strong>–í–∫–ª—é—á–µ–Ω:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç 10-–≤–æ–ø—Ä–æ—Å–Ω—ã–π —Ç–µ—Å—Ç, –ø—Å–∏—Ö–æ–ª–æ–≥–∏ –ø–æ–¥–±–∏—Ä–∞—é—Ç—Å—è –ø–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç</li>
        <li><strong>–í—ã–∫–ª—é—á–µ–Ω:</strong> –¢–µ—Å—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –≤—Å–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –±–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–∫—Ä—ã—Ç</li>
    </ul>
</div>
{% endblock %}

